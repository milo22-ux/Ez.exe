local url = "https://pastebin.com/raw/ZwL9ABFQ"

local function fetch(u)
    if syn and syn.request then
        local r = syn.request({Url = u, Method = "GET"})
        return r and (r.Body or r.body)
    elseif http and http.request then
        local r = http.request({Url = u, Method = "GET"})
        return r and (r.Body or r.body)
    elseif request then
        local r = request({Url = u, Method = "GET"})
        return r and (r.Body or r.body)
    elseif game and game.HttpGet then
        return game:HttpGet(u, true)
    end
    error("No supported HTTP method available")
end

local keys_text = fetch(url) or ""
local keys = {}
for line in keys_text:gmatch("[^\r\n]+") do
    table.insert(keys, line)
end

local key = getfenv().key
local allowed = false
for _, k in ipairs(keys) do
    if k == key then
        allowed = true
        break
    end
end

if allowed then
    print("whitelisted")
else
    print("not whitelisted")
end
