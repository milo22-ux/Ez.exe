local keys_url  = "https://pastebin.com/raw/ZwL9ABFQ"
local hwids_url = "https://pastebin.com/raw/YOUR_HWIDS_PASTEBIN"

local function fetch(u)
    if syn and syn.request then
        local r = syn.request({Url = u, Method = "GET"})
        return r and (r.Body or r.body)
    elseif http and http.request then
        local r = http.request({Url = u, method = "GET"})
        return r and (r.Body or r.body)
    elseif request then
        local r = request({Url = u, Method = "GET"})
        return r and (r.Body or r.body)
    elseif game and game.HttpGet then
        return game:HttpGet(u, true)
    end
    error("No supported HTTP method available")
end

local function split_lines(t)
    local out = {}
    for line in (t or ""):gmatch("[^\r\n]+") do
        line = line:match("^%s*(.-)%s*$")
        if line ~= "" then table.insert(out, line) end
    end
    return out
end

local keys_text  = fetch(keys_url)  or ""
local hwids_text = fetch(hwids_url) or ""

local keys  = split_lines(keys_text)
local hwids = split_lines(hwids_text)

local key  = (type(getfenv) == "function" and getfenv().key) or _G.key
local hwid = gethwid and gethwid() or "NO_HWID"

local allowed = false
if key and hwid and #keys == #hwids then
    for i = 1, #keys do
        if keys[i] == key and hwids[i] == hwid then
            allowed = true
            break
        end
    end
end

if allowed then
    print("whitelisted")
else
    print("not whitelisted")
end
